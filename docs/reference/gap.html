<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Gap Analysis — gap • EdSurvey</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Gap Analysis — gap" />
<meta property="og:description" content="Compares the average levels of a variable between two groups
             that potentially share members." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EdSurvey</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.7.0.9004</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction.html">Introduction to Analyzing NCES Data Using EdSurvey</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/American-Institutes-for-Research/EdSurvey/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Gap Analysis</h1>
    <small class="dont-index">Source: <a href='https://github.com/American-Institutes-for-Research/EdSurvey/blob/master/R/gap.R'><code>R/gap.R</code></a></small>
    <div class="hidden name"><code>gap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compares the average levels of a variable between two groups
             that potentially share members.</p>
    </div>

    <pre class="usage"><span class='fu'>gap</span><span class='op'>(</span>
  <span class='va'>variable</span>,
  <span class='va'>data</span>,
  groupA <span class='op'>=</span> <span class='st'>"default"</span>,
  groupB <span class='op'>=</span> <span class='st'>"default"</span>,
  percentiles <span class='op'>=</span> <span class='cn'>NULL</span>,
  achievementLevel <span class='op'>=</span> <span class='cn'>NULL</span>,
  achievementDiscrete <span class='op'>=</span> <span class='cn'>FALSE</span>,
  stDev <span class='op'>=</span> <span class='cn'>FALSE</span>,
  targetLevel <span class='op'>=</span> <span class='cn'>NULL</span>,
  weightVar <span class='op'>=</span> <span class='cn'>NULL</span>,
  jrrIMax <span class='op'>=</span> <span class='fl'>1</span>,
  varMethod <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"jackknife"</span><span class='op'>)</span>,
  omittedLevels <span class='op'>=</span> <span class='cn'>TRUE</span>,
  defaultConditions <span class='op'>=</span> <span class='cn'>TRUE</span>,
  recode <span class='op'>=</span> <span class='cn'>NULL</span>,
  referenceDataIndex <span class='op'>=</span> <span class='fl'>1</span>,
  returnVarEstInputs <span class='op'>=</span> <span class='cn'>FALSE</span>,
  returnSimpleDoF <span class='op'>=</span> <span class='cn'>FALSE</span>,
  returnSimpleN <span class='op'>=</span> <span class='cn'>FALSE</span>,
  returnNumberOfPSU <span class='op'>=</span> <span class='cn'>FALSE</span>,
  noCov <span class='op'>=</span> <span class='cn'>FALSE</span>,
  pctMethod <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"unbiased"</span>, <span class='st'>"symmetric"</span>, <span class='st'>"simple"</span><span class='op'>)</span>,
  includeLinkingError <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>variable</th>
      <td><p>a character indicating the variable to be compared,
potentially with a subject scale or subscale</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>an <code>edsurvey.data.frame</code>, a <code>light.edsurvey.data.frame</code>, or an <code>edsurvey.data.frame.list</code></p></td>
    </tr>
    <tr>
      <th>groupA</th>
      <td><p>an expression or character expression that defines a condition for the subset.
This subset will be compared to <code>groupB</code>. If not specified, it will define
a whole sample as in <code>data</code>.</p></td>
    </tr>
    <tr>
      <th>groupB</th>
      <td><p>an expression or character expression that defines a condition for the subset.
This subset will be compared to <code>groupA</code>. If not specified, it will define
a whole sample as in <code>data</code>. If set to <code>NULL</code>, estimates for the second group 
will be dropped.</p></td>
    </tr>
    <tr>
      <th>percentiles</th>
      <td><p>a numeric vector. The <code>gap</code> function calculates the
mean when this
argument is omitted or set to <code>NULL</code>. Otherwise,
the gap at the percentile given is calculated.</p></td>
    </tr>
    <tr>
      <th>achievementLevel</th>
      <td><p>the achievement level(s) at which percentages
should be calculated</p></td>
    </tr>
    <tr>
      <th>achievementDiscrete</th>
      <td><p>a logical indicating if the achievement level
specified in the <code>achievementLevel</code>
argument should be interpreted as discrete
so that
just the percentage in that particular achievement
level
will be included. Defaults to <code>FALSE</code>
so that
the percentage at or above that achievement level
will be
included in the percentage.</p></td>
    </tr>
    <tr>
      <th>stDev</th>
      <td><p>a logical, set to <code>TRUE</code> to calculate the gap in standard deviations.</p></td>
    </tr>
    <tr>
      <th>targetLevel</th>
      <td><p>a character string. When specified, calculates the gap in
the percentage of students at
<code>targetLevel</code> in the <code>variable</code> argument. This is useful for
comparing the gap in the percentage of students at a
survey response level.</p></td>
    </tr>
    <tr>
      <th>weightVar</th>
      <td><p>a character indicating the weight variable to use.
See Details.</p></td>
    </tr>
    <tr>
      <th>jrrIMax</th>
      <td><p>a numeric value; when using the jackknife variance estimation method, the default estimation option, <code>jrrIMax=1</code>, uses the 
sampling variance from the first plausible value as the component for sampling variance estimation. The <code>Vjrr</code> 
term, or sampeling variance term, can be estimated with any number of plausible values, and values larger than the number of 
plausible values on the survey (including <code>Inf</code>) will result in all plausible values being used. 
Higher values of <code>jrrIMax</code> lead to longer computing times and more accurate variance estimates.</p></td>
    </tr>
    <tr>
      <th>varMethod</th>
      <td><p>deprecated parameter, <code>gap</code> always uses the jackknife variance estimation</p></td>
    </tr>
    <tr>
      <th>omittedLevels</th>
      <td><p>a logical value. When set to the default value of
<code>TRUE</code>, drops those levels of 
all factor variables.
Use <code>print</code> on an <code>edsurvey.data.frame</code>
to see the omitted levels.</p></td>
    </tr>
    <tr>
      <th>defaultConditions</th>
      <td><p>a logical value. When set to the default value
of <code>TRUE</code>, uses the default 
conditions stored in <code>edsurvey.data.frame</code>
to subset the data. 
Use <code>print</code> on an <code>edsurvey.data.frame</code>
to see the default conditions.</p></td>
    </tr>
    <tr>
      <th>recode</th>
      <td><p>a list of lists to recode variables. Defaults to <code>NULL</code>.
Can be set as
<code>recode</code> <code><a href='https://rdrr.io/r/base/assignOps.html'>=</a></code> <code>list(var1</code> <code><a href='https://rdrr.io/r/base/assignOps.html'>=</a></code>
<code>list(from</code> <code><a href='https://rdrr.io/r/base/assignOps.html'>=</a></code> <code>c("a",</code> <code>"b",</code>
<code>"c"),</code> <code>to</code> <code><a href='https://rdrr.io/r/base/assignOps.html'>=</a></code> <code>"d"))</code>.</p></td>
    </tr>
    <tr>
      <th>referenceDataIndex</th>
      <td><p>a numeric used only when the <code>data</code> argument is an
<code>edsurvey.data.frame.list</code>,
indicating which dataset is the reference
dataset that other datasets are compared with. 
Defaults to 1.</p></td>
    </tr>
    <tr>
      <th>returnVarEstInputs</th>
      <td><p>a logical value; set to <code>TRUE</code> to return the
inputs to the jackknife and imputation variance
estimates which allows for the
computation
of covariances between estimates.</p></td>
    </tr>
    <tr>
      <th>returnSimpleDoF</th>
      <td><p>a logical value set to <code>TRUE</code> to return the degrees
of freedom for some statistics (see Value
section) that do not have a
<em>t</em>-test; useful primarily for further computation</p></td>
    </tr>
    <tr>
      <th>returnSimpleN</th>
      <td><p>a logical value set to <code>TRUE</code> to add the count
(<em>n</em>-size) of observations included in groups A and B
in the percentage object</p></td>
    </tr>
    <tr>
      <th>returnNumberOfPSU</th>
      <td><p>a logical value set to <code>TRUE</code> to return the number of 
PSUs used in the calculation</p></td>
    </tr>
    <tr>
      <th>noCov</th>
      <td><p>set the covariances to zero in result</p></td>
    </tr>
    <tr>
      <th>pctMethod</th>
      <td><p>a character that is one of <code>unbiased</code> or <code>simple</code>.
See the help for <code><a href='percentile.html'>percentile</a></code> for more information.</p></td>
    </tr>
    <tr>
      <th>includeLinkingError</th>
      <td><p>a logical value set to <code>TRUE</code> to include the
linking error in variance estimation.
Standard errors (e.g., <code>diffAAse</code>, <code>diffBBse</code>, 
and <code>diffABABse</code>) and <em>p</em>-values (e.g., <code>diffAApValue</code>, 
<code>diffBBpValue</code>, and <code>diffABABpValue</code>) would be adjusted for 
comparisons between digitally based assessments (DBA) and 
paper-based assessments (PBA) data.
This option is supported only for NAEP data.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The return type depends on if the class of the <code>data</code> argument is an
<code>edsurvey.data.frame</code> or an <code>edsurvey.data.frame.list</code>. Both
include the call (called <code>call</code>), a list called <code>labels</code>, 
an object named <code>percentage</code>
that shows the percentage in <code>groupA</code> and <code>groupB</code>, and an object
that shows the gap called <code>results</code>.</p>
<p>The labels include the following elements:</p>
<dt>definition</dt><dd><p>the definitions of the groups</p></dd>
  <dt>nFullData</dt><dd><p>the <em>n</em>-size for the full dataset (before applying the definition)</p></dd>
  <dt>nUsed</dt><dd><p>the <em>n</em>-size for the data after the group is subsetted and other
               restrictions (such as omitted values) are applied</p></dd>
  <dt>nPSU</dt><dd><p>the number of PSUs used in calculation--only returned when 
              <code>returnNumberOfPSU</code> <code><a href='https://rdrr.io/r/base/assignOps.html'>=</a></code> <code>TRUE</code></p></dd>

The percentages are computed according to the vignette titled
https://www.air.org/sites/default/files/EdSurvey-Statistics.pdf<em>Statistical Methods Used in EdSurvey</em>
 in the section
Estimation of Weighted Percentages When Plausible Values Are Not Present.
The standard errors are calculated according to
Estimation of the Standard Error of Weighted Percentages When Plausible Values Are Not Present, Using the Jackknife Method.
Standard errors of differences are calculated as the square root of the typical
variance formula
Var(A-B) = Var(A) + Var(B) - 2 Cov(A,B)
where the covariance term is calculated as described in the vignette titled
https://www.air.org/sites/default/files/EdSurvey-Statistics.pdf<em>Statistical Methods Used in EdSurvey</em>
 in the section
Estimation of Covariances. These degrees of freedom are available only
with the jackknife variance estimation. The degrees of freedom used for hypothesis testing
are always set to the number of jackknife replicates in the data.

the data argument is an edsurvey.data.frame
  When the data argument is an edsurvey.data.frame,
  gap returns an S3 object of class gap. 

  The percentage object is a numeric vector with the following elements:
    <dt>pctA</dt><dd><p>the percentage of respondents in <code>groupA</code> compared with the whole sample in <code>data</code></p></dd>
    <dt>pctAse</dt><dd><p>the standard error on the percentage of respondents in
                      <code>groupA</code></p></dd>
    <dt>dofA</dt><dd><p>degrees of freedom appropriate for a <em>t</em>-test involving <code>pctA</code>.
                This value is returned only if 
                <code>returnSimpleDoF</code><code><a href='https://rdrr.io/r/base/assignOps.html'>=</a></code><code>TRUE</code>.</p></dd>
    <dt>pctB</dt><dd><p>the percentage of respondents in <code>groupB</code>.</p></dd>
    <dt>pctBse</dt><dd><p>the standard error on the percentage of respondents in
                      <code>groupB</code></p></dd>
    <dt>dofB</dt><dd><p>degrees of freedom appropriate for a <em>t</em>-test involving <code>pctA</code>.
                This value is returned only if 
                <code>returnSimpleDoF</code><code><a href='https://rdrr.io/r/base/assignOps.html'>=</a></code><code>TRUE</code>.</p></dd>
    <dt>diffAB</dt><dd><p>the value of <code>pctA</code> minus <code>pctB</code></p></dd>
    <dt>covAB</dt><dd><p>the covariance of <code>pctA</code> and <code>pctB</code>; used in
                 calculating <code>diffABse</code>.</p></dd>
    <dt>diffABse</dt><dd><p>the standard error of <code>pctA</code>
                           minus <code>pctB</code></p></dd>
    <dt>diffABpValue</dt><dd><p>the <em>p</em>-value associated with the <em>t</em>-test used
                        for the hypothesis test that <code>diffAB</code>
                        is zero</p></dd>
    <dt>dofAB</dt><dd><p>degrees of freedom used in calculating
                      <code>diffABpValue</code></p></dd>

  The results object is a numeric data frame with the following elements:
    <dt>estimateA</dt><dd><p>the mean estimate of <code>groupA</code> (or the percentage estimate
                     if <code>achievementLevel</code> or <code>targetLevel</code> is specified)</p></dd>
    <dt>estimateAse</dt><dd><p>the standard error of <code>estimateA</code></p></dd>
    <dt>dofA</dt><dd><p>degrees of freedom appropriate for a <em>t</em>-test involving <code>meanA</code>.
                This value is returned only if 
                <code>returnSimpleDoF</code><code><a href='https://rdrr.io/r/base/assignOps.html'>=</a></code><code>TRUE</code>.</p></dd>
    <dt>estimateB</dt><dd><p>the mean estimate of <code>groupB</code> (or the percentage estimate
                     if <code>achievementLevel</code> or <code>targetLevel</code> is specified)</p></dd>
    <dt>estimateBse</dt><dd><p>the standard error of <code>estimateB</code></p></dd>
    <dt>dofB</dt><dd><p>degrees of freedom appropriate for a <em>t</em>-test involving <code>meanB</code>.
                This value is returned only if 
                <code>returnSimpleDoF</code><code><a href='https://rdrr.io/r/base/assignOps.html'>=</a></code><code>TRUE</code>.</p></dd>
    <dt>diffAB</dt><dd><p>the value of <code>estimateA</code> minus <code>estimateB</code></p></dd>
    <dt>covAB</dt><dd><p>the covariance of <code>estimateA</code> and <code>estimateB</code>. Used in
                 calculating <code>diffABse</code>.</p></dd>
    <dt>diffABse</dt><dd><p>the standard error of <code>diffAB</code></p></dd>
    <dt>diffABpValue</dt><dd><p>the <em>p</em>-value associated with the <em>t</em>-test used
                        for the hypothesis test that <code>diffAB</code>
                        is zero.</p></dd>
    <dt>dofAB</dt><dd><p>degrees of freedom used for the <em>t</em>-test on <code>diffAB</code></p></dd>
  
  If the gap was in  achievement levels or percentiles and more
  than one percentile or achievement level is requested,
  then an additional column
  labeled percentiles or achievementLevel is included
  in the results object.

  When results has a single row and when returnVarEstInputs
  is TRUE, the additional elements varEstInputs and
  pctVarEstInputs also are returned. These can be used for calculating
  covariances with <a href='varEstToCov.html'>varEstToCov</a>.

the data argument is an edsurvey.data.frame.list
  When the data argument is an edsurvey.data.frame.list,
  gap returns an S3 object of class gapList.
  
  The results object in the edsurveyResultList is
  a data.frame. Each row regards a particular dataset from the
  edsurvey.data.frame, and a reference dataset is dictated by
  the referenceDataIndex argument.
  
  The percentage object is a data.frame with the following elements:
    <dt>covs</dt><dd><p>a data frame with a column for each column in the <code>covs</code>. See previous
                section for more details.</p></dd>
    <dt>...</dt><dd><p>all elements in the <code>percentage</code> object in the
               previous section</p></dd>
    <dt>diffAA</dt><dd><p>the difference in <code>pctA</code> between the reference data
                  and this dataset. Set to <code>NA</code> for the
                  reference dataset.</p></dd>
    <dt>covAA</dt><dd><p>the covariance of <code>pctA</code> in the reference data and
                 <code>pctA</code> on this row. Used in
                 calculating <code>diffAAse</code>.</p></dd>
    <dt>diffAAse</dt><dd><p>the standard error for <code>diffAA</code></p></dd>
    <dt>diffAApValue</dt><dd><p>the <em>p</em>-value associated with the <em>t</em>-test used
                        for the hypothesis test that <code>diffAA</code>
                        is zero</p></dd>
    <dt>diffBB</dt><dd><p>the difference in <code>pctB</code> between the reference data
                  and this dataset. Set to <code>NA</code> for the
                  reference dataset.</p></dd>
    <dt>covBB</dt><dd><p>the covariance of <code>pctB</code> in the reference data and
                 <code>pctB</code> on this row. Used in
                 calculating <code>diffAAse</code>.</p></dd>
    <dt>diffBBse</dt><dd><p>the standard error for <code>diffBB</code></p></dd>
    <dt>diffBBpValue</dt><dd><p>the <em>p</em>-value associated with the <em>t</em>-test used
                        for the hypothesis test that <code>diffBB</code>
                        is zero</p></dd>
    <dt>diffABAB</dt><dd><p>the value of <code>diffAB</code> in the reference dataset
                           minus the value of <code>diffAB</code> in this dataset. Set
                           to <code>NA</code> for the reference dataset.</p></dd>
    <dt>covABAB</dt><dd><p>the covariance of <code>diffAB</code> in the reference data and
                   <code>diffAB</code> on this row. Used in
                   calculating <code>diffABABse</code>.</p></dd>
    <dt>diffABABse</dt><dd><p>the standard error for <code>diffABAB</code></p></dd>
    <dt>diffABABpValue</dt><dd><p>the <em>p</em>-value associated with the <em>t</em>-test used
                        for the hypothesis test that <code>diffABAB</code>
                        is zero</p></dd>

  The results object is a data.frame with the following elements:
    <dt>...</dt><dd><p>all elements in the <code>results</code> object in the
               previous section</p></dd>
    <dt>diffAA</dt><dd><p>the value of <code>groupA</code> in the reference dataset minus
                         the value in this dataset. Set to <code>NA</code> for the
                         reference dataset.</p></dd>
    <dt>covAA</dt><dd><p>the covariance of <code>meanA</code> in the reference data and
                 <code>meanA</code> on this row. Used in
                 calculating <code>diffAAse</code>.</p></dd>
    <dt>diffAAse</dt><dd><p>the standard error for <code>diffAA</code></p></dd>
    <dt>diffAApValue</dt><dd><p>the <em>p</em>-value associated with the <em>t</em>-test used
                        for the hypothesis test that <code>diffAA</code>
                        is zero</p></dd>
    <dt>diffBB</dt><dd><p>the value of <code>groupB</code> in the reference dataset minus
                         the value in this dataset. Set to <code>NA</code> for the
                         reference dataset.</p></dd>
    <dt>covBB</dt><dd><p>the covariance of <code>meanB</code> in the reference data and
                 <code>meanB</code> on this row. Used in
                 calculating <code>diffBBse</code>.</p></dd>
    <dt>diffBBse</dt><dd><p>the standard error for <code>diffBB</code></p></dd>
    <dt>diffBBpValue</dt><dd><p>the <em>p</em>-value associated with the <em>t</em>-test used
                        for the hypothesis test that <code>diffBB</code>
                        is zero</p></dd>
    <dt>diffABAB</dt><dd><p>the value of <code>diffAB</code> in the reference dataset
                           minus the value of <code>diffAB</code>
                           in this dataset. Set
                           to <code>NA</code> for the reference dataset.</p></dd>
    <dt>covABAB</dt><dd><p>the covariance of <code>diffAB</code> in the reference data and
                   <code>diffAB</code> on this row. Used in
                   calculating <code>diffABABse</code>.</p></dd>
    <dt>diffABABse</dt><dd><p>the standard error for <code>diffABAB</code></p></dd>
    <dt>diffABABpValue</dt><dd><p>the <em>p</em>-value associated with the <em>t</em>-test used
                        for the hypothesis test that <code>diffABAB</code>
                        is zero</p></dd>
    <dt>sameSurvey</dt><dd><p>a logical value indicating if this line uses the same
                      survey as the reference line. Set to <code>NA</code> for the
                      reference line.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function calculates the gap between <code>groupA</code> and <code>groupB</code> (which 
may be omitted to indicate the full sample). The gap is
calculated for one of four statistics:</p><dl>
  <dt>the gap in means</dt><dd><p>The mean score gap (in the score
     variable) identified in the <code>variable</code> argument.
     This is the default. The means and their standard errors are
     calculated using the methods
     described in the <code><a href='lm.sdf.html'>lm.sdf</a></code> function documentation.</p></dd>
  <dt>the gap in percentiles</dt><dd><p>The gap between respondents at
     the percentiles specified in the <code>percentiles</code> argument.
     This is returned when the <code>percentiles</code> argument is
     defined. The mean and standard error are computed as described in the 
     <code><a href='percentile.html'>percentile</a></code> function documentation.</p></dd>
  <dt>the gap in achievement levels</dt><dd><p>The gap in the percentage of 
     students at (when <code>achievementDiscrete</code> is <code>TRUE</code>) or at
     or above (when <code>achievementDiscrete</code> is <code>FALSE</code>) a
     particular achievement level. This is used when the 
     <code>achievementLevel</code> argument is defined. The mean and standard error
     are calculated as described in the <code><a href='achievementLevels.html'>achievementLevels</a></code>
     function documentation.</p></dd>
  <dt>the gap in a survey response</dt><dd><p>The gap in the percentage of
     respondents responding at <code>targetLevel</code> to 
     <code>variable</code>. This is used when <code>targetLevel</code> is
     defined. The mean and standard deviation are calculated as described in
     the <code><a href='edsurveyTable.html'>edsurveyTable</a></code> function documentation.</p></dd>

</dl>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Paul Bailey, Trang Nguyen, and Huade Huo</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># read in the example data (generated, not real student data)</span>
<span class='va'>sdf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='readNAEP.html'>readNAEP</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata/data"</span>, <span class='st'>"M36NT2PM.dat"</span>, package <span class='op'>=</span> <span class='st'>"NAEPprimer"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># find the mean score gap in the primer data between males and females</span>
<span class='fu'>gap</span><span class='op'>(</span><span class='st'>"composite"</span>, <span class='va'>sdf</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Male"</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Female"</span><span class='op'>)</span>

<span class='co'># find the score gap of the quartiles in the primer data between males and females</span>
<span class='fu'>gap</span><span class='op'>(</span><span class='st'>"composite"</span>, <span class='va'>sdf</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Male"</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Female"</span>, percentile<span class='op'>=</span><span class='fl'>50</span><span class='op'>)</span>
<span class='fu'>gap</span><span class='op'>(</span><span class='st'>"composite"</span>, <span class='va'>sdf</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Male"</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Female"</span>, percentile<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>25</span>, <span class='fl'>50</span>, <span class='fl'>75</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># find the percent proficient (or higher) gap in the primer data between males and females</span>
<span class='fu'>gap</span><span class='op'>(</span><span class='st'>"composite"</span>, <span class='va'>sdf</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Male"</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Female"</span>, 
    achievementLevel<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Basic"</span>, <span class='st'>"Proficient"</span>, <span class='st'>"Advanced"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># find the discrete achievement level gap--this is harder to interpret</span>
<span class='fu'>gap</span><span class='op'>(</span><span class='st'>"composite"</span>, <span class='va'>sdf</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Male"</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Female"</span>,
    achievementLevel<span class='op'>=</span><span class='st'>"Proficient"</span>, achievementDiscrete<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># find the percent talk about studies at home (b017451) never or hardly</span>
<span class='co'># ever gap in the primer data between males and females</span>
<span class='fu'>gap</span><span class='op'>(</span><span class='st'>"b017451"</span>, <span class='va'>sdf</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Male"</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Female"</span>, 
    targetLevel<span class='op'>=</span><span class='st'>"Never or hardly ever"</span><span class='op'>)</span>

<span class='co'># example showing how to compare multiple levels</span>
<span class='fu'>gap</span><span class='op'>(</span><span class='st'>"b017451"</span>,<span class='va'>sdf</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Male"</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Female"</span>, targetLevel<span class='op'>=</span><span class='st'>"Infrequently"</span>,
    recode<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>b017451<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>from<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Never or hardly ever"</span>,
                                    <span class='st'>"Once every few weeks"</span>,
                                    <span class='st'>"About once a week"</span><span class='op'>)</span>,
                             to<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Infrequently"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># make subsets of sdf by scrpsu, "Scrambled PSU and school code"</span>
<span class='va'>sdfA</span> <span class='op'>&lt;-</span> <span class='fu'><a href='subset.html'>subset</a></span><span class='op'>(</span><span class='va'>sdf</span>, <span class='va'>scrpsu</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>45</span>,<span class='fl'>56</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>sdfB</span> <span class='op'>&lt;-</span> <span class='fu'><a href='subset.html'>subset</a></span><span class='op'>(</span><span class='va'>sdf</span>, <span class='va'>scrpsu</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>75</span>,<span class='fl'>76</span>,<span class='fl'>78</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>sdfC</span> <span class='op'>&lt;-</span> <span class='fu'><a href='subset.html'>subset</a></span><span class='op'>(</span><span class='va'>sdf</span>, <span class='va'>scrpsu</span> <span class='op'>%in%</span> <span class='fl'>100</span><span class='op'>:</span><span class='fl'>200</span><span class='op'>)</span>
<span class='va'>sdfD</span> <span class='op'>&lt;-</span> <span class='fu'><a href='subset.html'>subset</a></span><span class='op'>(</span><span class='va'>sdf</span>, <span class='va'>scrpsu</span> <span class='op'>%in%</span> <span class='fl'>201</span><span class='op'>:</span><span class='fl'>300</span><span class='op'>)</span>

<span class='va'>sdfl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='edsurvey.data.frame.list.html'>edsurvey.data.frame.list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>sdfA</span>, <span class='va'>sdfB</span>, <span class='va'>sdfC</span>, <span class='va'>sdfD</span><span class='op'>)</span>,
                                 labels<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"A locations"</span>, <span class='st'>"B locations"</span>,
                                          <span class='st'>"C locations"</span>, <span class='st'>"D locations"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>gap</span><span class='op'>(</span><span class='st'>"composite"</span>, <span class='va'>sdfl</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Male"</span>, <span class='va'>dsex</span><span class='op'>==</span><span class='st'>"Female"</span>, percentile<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># example showing using linking error with gap</span>
<span class='co'># load Grade 4 math data</span>
<span class='co'># requires NAEP RUD license with these files in the folder the user is currectly in</span>
<span class='va'>g4math2015</span> <span class='op'>&lt;-</span> <span class='fu'><a href='readNAEP.html'>readNAEP</a></span><span class='op'>(</span><span class='st'>"M46NT1AT.dat"</span><span class='op'>)</span>
<span class='va'>g4math2017</span> <span class='op'>&lt;-</span> <span class='fu'><a href='readNAEP.html'>readNAEP</a></span><span class='op'>(</span><span class='st'>"M48NT1AT.dat"</span><span class='op'>)</span>
<span class='va'>g4math2019</span> <span class='op'>&lt;-</span> <span class='fu'><a href='readNAEP.html'>readNAEP</a></span><span class='op'>(</span><span class='st'>"M50NT1AT.dat"</span><span class='op'>)</span>

<span class='co'># make an edsurvey.data.frame.list from math grade 4 2015, 2017, and 2019 data</span>
<span class='va'>g4math</span> <span class='op'>&lt;-</span> <span class='fu'><a href='edsurvey.data.frame.list.html'>edsurvey.data.frame.list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>g4math2019</span>, <span class='va'>g4math2017</span>, <span class='va'>g4math2015</span><span class='op'>)</span>,
                                   labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"2019"</span>, <span class='st'>"2017"</span>, <span class='st'>"2015"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># gap analysis with linking error in variance estimation across surveys</span>
<span class='fu'>gap</span><span class='op'>(</span><span class='st'>"composite"</span>, <span class='va'>g4math</span>, <span class='va'>dsex</span> <span class='op'>==</span> <span class='st'>"Male"</span>, <span class='va'>dsex</span> <span class='op'>==</span> <span class='st'>"Female"</span>, includeLinkingError<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>gap</span><span class='op'>(</span><span class='st'>"composite"</span>, <span class='va'>g4math</span>, <span class='va'>dsex</span> <span class='op'>==</span> <span class='st'>"Male"</span>, <span class='va'>dsex</span> <span class='op'>==</span> <span class='st'>"Female"</span>, percentiles <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>25</span><span class='op'>)</span>, 
    includeLinkingError<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>gap</span><span class='op'>(</span><span class='st'>"composite"</span>, <span class='va'>g4math</span>, <span class='va'>dsex</span> <span class='op'>==</span> <span class='st'>"Male"</span>, <span class='va'>dsex</span> <span class='op'>==</span> <span class='st'>"Female"</span>, 
    achievementDiscrete <span class='op'>=</span> <span class='cn'>TRUE</span>, achievementLevel<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Basic"</span>, <span class='st'>"Proficient"</span>, <span class='st'>"Advanced"</span><span class='op'>)</span>, 
    includeLinkingError<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Paul Bailey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


