<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>EdSurvey Tables With Conditional Means — edsurveyTable • EdSurvey</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="EdSurvey Tables With Conditional Means — edsurveyTable"><meta name="description" content="Returns a summary table (as a data.frame)
that shows the number of students, the percentage of students, and the mean
value of the outcome (or left-hand side) variable by the
predictor (or right-hand side) variable(s)."><meta property="og:description" content="Returns a summary table (as a data.frame)
that shows the number of students, the percentage of students, and the mean
value of the outcome (or left-hand side) variable by the
predictor (or right-hand side) variable(s)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EdSurvey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction to Analyzing NCES Data Using EdSurvey</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/American-Institutes-for-Research/EdSurvey/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>EdSurvey Tables With Conditional Means</h1>
      <small class="dont-index">Source: <a href="https://github.com/American-Institutes-for-Research/EdSurvey/blob/HEAD/R/edsurveyTable.R" class="external-link"><code>R/edsurveyTable.R</code></a></small>
      <div class="d-none name"><code>edsurveyTable.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Returns a summary table (as a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code>)
that shows the number of students, the percentage of students, and the mean
value of the outcome (or left-hand side) variable by the
predictor (or right-hand side) variable(s).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">edsurveyTable</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  weightVar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  jrrIMax <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pctAggregationLevel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  returnMeans <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  returnSepct <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  varMethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"jackknife"</span>, <span class="st">"Taylor"</span><span class="op">)</span>,</span>
<span>  drop <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dropOmittedLevels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  defaultConditions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  recode <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  returnVarEstInputs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  omittedLevels <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>object of class <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code>,
potentially with
a subject scale or subscale
on the left-hand side and
variables to tabulate
on the right-hand side.
When the left-hand side of the
formula is omitted and <code>returnMeans</code> is <code>TRUE</code>,
then the default subject scale or subscale is used.
You can find the default composite scale and all subscales
using the function <code><a href="showPlausibleValues.html">showPlausibleValues</a></code>.
Note that the order of the right-hand side variables affects the output.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>object of class <code>edsurvey.data.frame</code>. See <code><a href="readNAEP.html">readNAEP</a></code>
for how to generate an <code>edsurvey.data.frame</code>.</p></dd>


<dt id="arg-weightvar">weightVar<a class="anchor" aria-label="anchor" href="#arg-weightvar"></a></dt>
<dd><p>character string indicating the weight variable to use.
Note that only the name of the
weight variable needs to be included here, and any
replicate weights will be automatically included.
When this argument is <code>NULL</code>, the function uses the default.
Use <code><a href="showWeights.html">showWeights</a></code> to find the default.</p></dd>


<dt id="arg-jrrimax">jrrIMax<a class="anchor" aria-label="anchor" href="#arg-jrrimax"></a></dt>
<dd><p>a numeric value; when using the jackknife variance estimation method, the default estimation option, <code>jrrIMax=1</code>, uses the
  sampling variance from the first plausible value as the component for sampling variance estimation. The \(V_{jrr}\)
  term (see the Details section of
<code><a href="lm.sdf.html">lm.sdf</a></code> to see the definition of \(V_{jrr}\)) can be estimated with any number of plausible values, and values larger than the number of
  plausible values on the survey (including <code>Inf</code>) will result in all of the plausible values being used.
  Higher values of <code>jrrIMax</code> lead to longer computing times and more accurate variance estimates.</p></dd>


<dt id="arg-pctaggregationlevel">pctAggregationLevel<a class="anchor" aria-label="anchor" href="#arg-pctaggregationlevel"></a></dt>
<dd><p>the percentage variable sums up to 100 for the first
<code>pctAggregationLevel</code> columns.
So, when set to <code>0</code>, the <code>PCT</code> column adds up to 1
across the entire sample.
When set to <code>1</code>, the <code>PCT</code> column adds up to 1
within each level of the first variable on the
right-hand side of the formula; when set to <code>2</code>,
then the percentage
adds up to 100 within the interaction of the
first and second variable, and so on.
Default is <code>NULL</code>, which will result in the
lowest feasible aggregation level.
See Examples section.</p></dd>


<dt id="arg-returnmeans">returnMeans<a class="anchor" aria-label="anchor" href="#arg-returnmeans"></a></dt>
<dd><p>a logical value; set to <code>TRUE</code> (the default) to get the <code>MEAN</code> and
<code>SE(MEAN)</code> columns in the returned table described in the Value section.</p></dd>


<dt id="arg-returnsepct">returnSepct<a class="anchor" aria-label="anchor" href="#arg-returnsepct"></a></dt>
<dd><p>set to <code>TRUE</code> (the default) to get the <code>SEPCT</code> column in the returned table described in the Value section.</p></dd>


<dt id="arg-varmethod">varMethod<a class="anchor" aria-label="anchor" href="#arg-varmethod"></a></dt>
<dd><p>a character set to <code>jackknife</code> or <code>Taylor</code> that indicates the variance estimation method
to be used.</p></dd>


<dt id="arg-drop">drop<a class="anchor" aria-label="anchor" href="#arg-drop"></a></dt>
<dd><p>a logical value. When set to the default value of <code>FALSE</code>, when a single column is returned, it is still represented as a <code>data.frame</code> and is
not converted to a vector.</p></dd>


<dt id="arg-dropomittedlevels">dropOmittedLevels<a class="anchor" aria-label="anchor" href="#arg-dropomittedlevels"></a></dt>
<dd><p>a logical value. When set to the default value of <code>TRUE</code>, drops those levels of all factor variables that are specified
in an <code>edsurvey.data.frame</code>. Use <code>print</code> on an <code>edsurvey.data.frame</code> to see the omitted levels.</p></dd>


<dt id="arg-defaultconditions">defaultConditions<a class="anchor" aria-label="anchor" href="#arg-defaultconditions"></a></dt>
<dd><p>a logical value. When set to the default value of <code>TRUE</code>, uses the default conditions stored in an <code>edsurvey.data.frame</code>
to subset the data. Use <code>print</code> on an <code>edsurvey.data.frame</code> to see the default conditions.</p></dd>


<dt id="arg-recode">recode<a class="anchor" aria-label="anchor" href="#arg-recode"></a></dt>
<dd><p>a list of lists to recode variables. Defaults to <code>NULL</code>. Can be set as
<code>recode</code> <code>=</code> <code>list(var1</code> <code>=</code> <code>list(from</code> <code>=</code> <code>c("a", "b", "c"),</code> <code>to</code> <code>=</code> <code>"c"))</code>.</p></dd>


<dt id="arg-returnvarestinputs">returnVarEstInputs<a class="anchor" aria-label="anchor" href="#arg-returnvarestinputs"></a></dt>
<dd><p>a logical value set to <code>TRUE</code> to return the
inputs to the jackknife and imputation variance
estimates, which allows for
the computation
of covariances between estimates.</p></dd>


<dt id="arg-omittedlevels">omittedLevels<a class="anchor" aria-label="anchor" href="#arg-omittedlevels"></a></dt>
<dd><p>this argument is deprecated. Use <code>dropOmittedLevels</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A table with the following columns:</p>
<dl><dt>RHS levels</dt>
<dd><p>one column for each right-hand side variable. Each row
                     regards students who are at the levels shown in that row.</p></dd>

   <dt>N</dt>
<dd><p>count of the number of students in the survey in the <code>RHS levels</code></p></dd>

   <dt>WTD_N</dt>
<dd><p>the weighted <em>N</em> count of students in the survey in <code>RHS levels</code></p></dd>

   <dt>PCT</dt>
<dd><p>the percentage of students at the aggregation level specified by <code>pctAggregationLevel</code> (see Arguments).
                     See the vignette titled
        <a href="https://www.air.org/sites/default/files/EdSurvey-Statistics.pdf" class="external-link"><em>Statistical Methods Used in EdSurvey</em></a>
            in the section
“Estimation of Weighted Percentages” and its first subsection
“Estimation of Weighted Percentages When Plausible Values Are Not Present.”</p></dd>

   <dt>SE(PCT)</dt>
<dd><p>the standard  error of the percentage, accounting
                         for the survey sampling methodology. When <code>varMethod</code>
                         is the <code>jackknife</code>, the calculation of this column is
                         described in the vignette titled
<a href="https://www.air.org/sites/default/files/EdSurvey-Statistics.pdf" class="external-link"><em>Statistical Methods Used in EdSurvey</em></a>
 in the section
“Estimation of the Standard Error of Weighted Percentages When Plausible Values Are Not Present, Using the Jackknife Method.”
                      When <code>varMethod</code> is set to <code>Taylor</code>, the calculation of this column is described in
“Estimation of the Standard Error of Weighted Percentages When Plausible Values Are Not Present, Using the Taylor Series Method.”</p></dd>

   <dt>MEAN</dt>
<dd><p>the mean assessment score for units in the <code>RHS levels</code>, calculated according to the  vignette titled
<a href="https://www.air.org/sites/default/files/EdSurvey-Statistics.pdf" class="external-link"><em>Statistical Methods Used in EdSurvey</em></a>
in the section
“Estimation of Weighted Means When Plausible Values Are Present.”</p></dd>

   <dt>SE(MEAN)</dt>
<dd><p>the standard error of the <code>MEAN</code> column (the mean assessment score for units in the <code>RHS levels</code>), calculated according to the vignette titled
<a href="https://www.air.org/sites/default/files/EdSurvey-Statistics.pdf" class="external-link"><em>Statistical Methods Used in EdSurvey</em></a>
in the sections
“Estimation of Standard Errors of Weighted Means When Plausible Values Are Present, Using the Jackknife Method”
or
“Estimation of Standard Errors of Weighted Means When Plausible Values Are Present, Using the Taylor Series Method,”
depending on the value of <code>varMethod</code>.</p></dd>


</dl><p>When <code>returnVarEstInputs</code> is <code>TRUE</code>, two additional elements are
 returned. These are <code>meanVarEstInputs</code> and <code>pctVarEstInputs</code> and
 regard the <code>MEAN</code> and <code>PCT</code> columns, respectively. These two
 objects can be used for calculating covariances with
 <code><a href="varEstToCov.html">varEstToCov</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This method can be used to generate a simple one-way, two-way, or
<em>n</em>-way
table with unweighted and weighted <em>n</em> values and percentages. It also
can calculate the average of the subject scale or subscale for students at
each level of the cross-tabulation table.</p>
<p>A detailed description of all statistics is given in the vignette titled
<a href="https://www.air.org/sites/default/files/EdSurvey-Statistics.pdf" class="external-link"><em>Statistical Methods Used in EdSurvey</em></a>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Binder, D. A. (1983). On the variances of asymptotically normal estimators from complex surveys. <em>International Statistical Review</em>, <em>51</em>(3), 279–292.</p>
<p>Rubin, D. B. (1987). <em>Multiple imputation for nonresponse in surveys</em>. New York, NY: Wiley.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Paul Bailey and Ahmad Emad</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># read in the example data (generated, not real student data)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="readNAEP.html">readNAEP</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/data"</span>, <span class="st">"M36NT2PM.dat"</span>, package <span class="op">=</span> <span class="st">"NAEPprimer"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create a table that shows only the breakdown of dsex</span></span></span>
<span class="r-in"><span><span class="fu">edsurveyTable</span><span class="op">(</span>formula<span class="op">=</span><span class="va">composite</span> <span class="op">~</span> <span class="va">dsex</span>, data<span class="op">=</span><span class="va">sdf</span>, returnMeans<span class="op">=</span><span class="cn">FALSE</span>, returnSepct<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create a table with composite scores by dsex</span></span></span>
<span class="r-in"><span><span class="fu">edsurveyTable</span><span class="op">(</span>formula<span class="op">=</span><span class="va">composite</span> <span class="op">~</span> <span class="va">dsex</span>, data<span class="op">=</span><span class="va">sdf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add a second variable</span></span></span>
<span class="r-in"><span><span class="fu">edsurveyTable</span><span class="op">(</span>formula<span class="op">=</span><span class="va">composite</span> <span class="op">~</span> <span class="va">dsex</span> <span class="op">+</span> <span class="va">b017451</span>, data<span class="op">=</span><span class="va">sdf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add a second variable, do not omit any levels</span></span></span>
<span class="r-in"><span><span class="fu">edsurveyTable</span><span class="op">(</span>formula<span class="op">=</span><span class="va">composite</span> <span class="op">~</span> <span class="va">dsex</span> <span class="op">+</span> <span class="va">b017451</span> <span class="op">+</span> <span class="va">b003501</span>, data<span class="op">=</span><span class="va">sdf</span>, omittedLevels<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add a second variable, do not omit any levels, change aggregation level</span></span></span>
<span class="r-in"><span><span class="fu">edsurveyTable</span><span class="op">(</span>formula<span class="op">=</span><span class="va">composite</span> <span class="op">~</span> <span class="va">dsex</span> <span class="op">+</span> <span class="va">b017451</span> <span class="op">+</span> <span class="va">b003501</span>, data<span class="op">=</span><span class="va">sdf</span>, omittedLevels<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              pctAggregationLevel<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">edsurveyTable</span><span class="op">(</span>formula<span class="op">=</span><span class="va">composite</span> <span class="op">~</span> <span class="va">dsex</span> <span class="op">+</span> <span class="va">b017451</span> <span class="op">+</span> <span class="va">b003501</span>, data<span class="op">=</span><span class="va">sdf</span>, omittedLevels<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              pctAggregationLevel<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">edsurveyTable</span><span class="op">(</span>formula<span class="op">=</span><span class="va">composite</span> <span class="op">~</span> <span class="va">dsex</span> <span class="op">+</span> <span class="va">b017451</span> <span class="op">+</span> <span class="va">b003501</span>, data<span class="op">=</span><span class="va">sdf</span>, omittedLevels<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>              pctAggregationLevel<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># variance estimation using the Taylor series </span></span></span>
<span class="r-in"><span><span class="fu">edsurveyTable</span><span class="op">(</span>formula<span class="op">=</span><span class="va">composite</span> <span class="op">~</span> <span class="va">dsex</span> <span class="op">+</span> <span class="va">b017451</span> <span class="op">+</span> <span class="va">b003501</span>, data<span class="op">=</span><span class="va">sdf</span>, varMethod<span class="op">=</span><span class="st">"Taylor"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul Bailey, Ahmad Emad, Huade Huo, Michael Lee, Yuqi Liao, Alex Lishinski, Trang Nguyen, Qingshu Xie, Jiao Yu, Ting Zhang, Eric Buehler, Sun-joo Lee, Blue Webb, Thomas Fink, Sinan Yavuz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

