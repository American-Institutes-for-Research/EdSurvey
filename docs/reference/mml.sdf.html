<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>EdSurvey Direct Estimation — mml.sdf • EdSurvey</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="EdSurvey Direct Estimation — mml.sdf"><meta name="description" content="Prepare IRT parameters and score items and then estimate a linear model with direct estimation."><meta property="og:description" content="Prepare IRT parameters and score items and then estimate a linear model with direct estimation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EdSurvey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction to Analyzing NCES Data Using EdSurvey</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/American-Institutes-for-Research/EdSurvey/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>EdSurvey Direct Estimation</h1>
      <small class="dont-index">Source: <a href="https://github.com/American-Institutes-for-Research/EdSurvey/blob/HEAD/R/mml.sdf.R" class="external-link"><code>R/mml.sdf.R</code></a></small>
      <div class="d-none name"><code>mml.sdf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Prepare IRT parameters and score items and then estimate a linear model with direct estimation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mml.sdf</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  weightVar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dropOmittedLevels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  composite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  multiCore <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  numberOfCores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  minNode <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>,</span>
<span>  maxNode <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  Q <span class="op">=</span> <span class="fl">34</span>,</span>
<span>  idVar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  returnMmlCall <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  omittedLevels <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></code> for the
model.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an <code>edsurvey.data.frame</code> for the National Assessment of Educational Progress (NAEP)
and the Trends in International Mathematics and Science Study (TIMSS).
The attributes <code>dichotParamTab</code>, <code>polyParamTab</code>, <code>testData</code>,
<code>scoreCard</code> (for NAEP), and <code>scoreDict</code> (for TIMSS) must not be <code>NULL</code>.
Use the function <code>setNAEPScoreCard</code> or <code>setAttributes</code> to set attributes.</p></dd>


<dt id="arg-weightvar">weightVar<a class="anchor" aria-label="anchor" href="#arg-weightvar"></a></dt>
<dd><p>a character indicating the weight variable to use.
The <code>weightVar</code> must be one of the weights for the
<code>edsurvey.data.frame</code>. If <code>NULL</code>, it  uses the default
for the <code>edsurvey.data.frame</code>.</p></dd>


<dt id="arg-dropomittedlevels">dropOmittedLevels<a class="anchor" aria-label="anchor" href="#arg-dropomittedlevels"></a></dt>
<dd><p>a logical value. When set to the value of <code>TRUE</code>, drops
the levels of all factor variables that are specified
in an <code>edsurvey.data.frame</code>. Use <code>print</code> on an
<code>edsurvey.data.frame</code> to see the omitted levels.
To draw plausible values for the full dataset, the user must set this to <code>FALSE</code>.</p></dd>


<dt id="arg-composite">composite<a class="anchor" aria-label="anchor" href="#arg-composite"></a></dt>
<dd><p>logical; for a NAEP composite, setting to <code>FALSE</code> fits the model to all items at once,
in a single construct, whereas setting to <code>TRUE</code> fits the model as a NAEP composite
(i.e., a weighted average of the subscales). This argument is not applicable for TIMSS which is always
fit as an overall (non-composite).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical; indicates whether a detailed printout should display during execution, only for NAEP data.</p></dd>


<dt id="arg-multicore">multiCore<a class="anchor" aria-label="anchor" href="#arg-multicore"></a></dt>
<dd><p>allows the <code>foreach</code> package to be used. This function will setup and take down the cluster.</p></dd>


<dt id="arg-numberofcores">numberOfCores<a class="anchor" aria-label="anchor" href="#arg-numberofcores"></a></dt>
<dd><p>the number of cores to be used when using <code>multiCore</code>. Defaults to 75% of available cores. Users
can check available cores with <code>detectCores()</code>.</p></dd>


<dt id="arg-minnode">minNode<a class="anchor" aria-label="anchor" href="#arg-minnode"></a></dt>
<dd><p>numeric; minimum integration point in direct estimation; see <code><a href="https://american-institutes-for-research.github.io/Dire/reference/mml.html" class="external-link">mml</a></code>.</p></dd>


<dt id="arg-maxnode">maxNode<a class="anchor" aria-label="anchor" href="#arg-maxnode"></a></dt>
<dd><p>numeric; maximum integration point in direct estimation; see <code><a href="https://american-institutes-for-research.github.io/Dire/reference/mml.html" class="external-link">mml</a></code>.</p></dd>


<dt id="arg-q">Q<a class="anchor" aria-label="anchor" href="#arg-q"></a></dt>
<dd><p>integer; number of integration points per student used when integrating over the levels of the latent outcome construct.</p></dd>


<dt id="arg-idvar">idVar<a class="anchor" aria-label="anchor" href="#arg-idvar"></a></dt>
<dd><p>a variable that is used to explicitly define the name of the student identifier
variable to be used from <code>data</code>. Defaults to <code>NULL</code>, and <code>sid</code> is used
as the student identifier.</p></dd>


<dt id="arg-returnmmlcall">returnMmlCall<a class="anchor" aria-label="anchor" href="#arg-returnmmlcall"></a></dt>
<dd><p>logical; when <code>TRUE</code>, do not process the mml call but instead return it for the user to edit before calling</p></dd>


<dt id="arg-omittedlevels">omittedLevels<a class="anchor" aria-label="anchor" href="#arg-omittedlevels"></a></dt>
<dd><p>this argument is deprecated. Use <code>dropOmittedLevels</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code>mml.sdf</code> object, which is the outcome from <code>mml.sdf</code>, with the following elements:</p>
<dl><dt>mml</dt>
<dd><p>an object containing information from the <code>mml</code> procedure.
   <code>?mml</code> can be used for further information.</p></dd>

   <dt>scoreDict</dt>
<dd><p>the scoring used in the <code>mml</code> procedure</p></dd>
</dl><p>.</p>
<dl><dt>itemMapping</dt>
<dd><p>the item mapping used in the <code>mml</code> procedure</p></dd>
</dl><p>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Typically, models are fit with NAEP data using plausible values to integrate out the uncertainty in the measurement of individual
student outcomes. When direct estimation is used, the measurement error is integrated out explicitly using <code>Q</code> quadrature points.
See documentation for <code><a href="https://american-institutes-for-research.github.io/Dire/reference/mml.html" class="external-link">mml</a></code> in the <code>Dire</code> package.</p>
<p>The <code>scoreDict</code> helps turn response categories that are not simple item responses, such as <code>Not Reached</code> and <code>Multiple</code>,
to something coded as inputs for the <code>mml</code> function in <code>Dire</code>. How <code>mml</code> treats these values depends on the test.
For NAEP, for a dichotomous item, 8 is scored as the same proportion correct as the guessing parameter for that item, 0 is
an incorrect response, an NA does not change the student's score, and 1 is correct. TIMSS does not require a <code>scoreDict</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Cohen, J., &amp; Jiang, T. (1999). Comparison of partially measured latent traits across nominal subgroups.
   <em>Journal of the American Statistical Association</em>, <em>94</em>(448), 1035–1044. https://doi.org/10.2307/2669917</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## Direct Estimation with NAEP </span></span></span>
<span class="r-in"><span><span class="co"># Load data </span></span></span>
<span class="r-in"><span><span class="va">sdfNAEP</span> <span class="op">&lt;-</span> <span class="fu"><a href="readNAEP.html">readNAEP</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/data"</span>, <span class="st">"M36NT2PM.dat"</span>, package <span class="op">=</span> <span class="st">"NAEPprimer"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inspect scoring guidelines</span></span></span>
<span class="r-in"><span><span class="fu">defaultNAEPScoreCard</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example output: </span></span></span>
<span class="r-in"><span><span class="co">#          resCat pointMult pointConst</span></span></span>
<span class="r-in"><span><span class="co"># 1     Multiple         8          0</span></span></span>
<span class="r-in"><span><span class="co"># 2  Not Reached        NA         NA</span></span></span>
<span class="r-in"><span><span class="co"># 3      Missing        NA         NA</span></span></span>
<span class="r-in"><span><span class="co"># 4      Omitted         8          0</span></span></span>
<span class="r-in"><span><span class="co"># 5    Illegible         0          0</span></span></span>
<span class="r-in"><span><span class="co"># 6 Non-Rateable         0          0</span></span></span>
<span class="r-in"><span><span class="co"># 7     Off Task         0          0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run NAEP model, warnings are about item codings</span></span></span>
<span class="r-in"><span><span class="va">mmlNAEP</span> <span class="op">&lt;-</span> <span class="fu">mml.sdf</span><span class="op">(</span>formula<span class="op">=</span><span class="va">algebra</span> <span class="op">~</span> <span class="va">dsex</span> <span class="op">+</span> <span class="va">b013801</span>, data<span class="op">=</span><span class="va">sdfNAEP</span>, weightVar<span class="op">=</span><span class="st">'origwt'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Call with Taylor</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mmlNAEP</span>, varType<span class="op">=</span><span class="st">"Taylor"</span>, strataVar<span class="op">=</span><span class="st">"repgrp1"</span>, PSUVar<span class="op">=</span><span class="st">"jkunit"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Direct Estimation with TIMSS </span></span></span>
<span class="r-in"><span><span class="co"># Load data </span></span></span>
<span class="r-in"><span><span class="fu"><a href="downloadTIMSS.html">downloadTIMSS</a></span><span class="op">(</span><span class="st">"~/"</span>, year<span class="op">=</span><span class="fl">2015</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sdfTIMSS</span> <span class="op">&lt;-</span> <span class="fu"><a href="readTIMSS.html">readTIMSS</a></span><span class="op">(</span>path<span class="op">=</span><span class="st">"~/TIMSS/2015"</span>, countries<span class="op">=</span><span class="st">"usa"</span>, grade <span class="op">=</span> <span class="st">"4"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run TIMSS model, warnings are about item codings </span></span></span>
<span class="r-in"><span><span class="va">mmlTIMSS</span> <span class="op">&lt;-</span> <span class="fu">mml.sdf</span><span class="op">(</span>formula<span class="op">=</span><span class="va">mmat</span> <span class="op">~</span> <span class="va">itsex</span> <span class="op">+</span> <span class="va">asbg04</span>, data<span class="op">=</span><span class="va">sdfTIMSS</span>, weightVar<span class="op">=</span><span class="st">'totwgt'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Call with Taylor</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mmlTIMSS</span>, varType<span class="op">=</span><span class="st">"Taylor"</span>, strataVar<span class="op">=</span><span class="st">"jkzone"</span>, PSUVar<span class="op">=</span><span class="st">"jkrep"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul Bailey, Ahmad Emad, Huade Huo, Michael Lee, Yuqi Liao, Alex Lishinski, Trang Nguyen, Qingshu Xie, Jiao Yu, Ting Zhang, Eric Buehler, Sun-joo Lee, Blue Webb, Thomas Fink, Sinan Yavuz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

